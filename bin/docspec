#!/usr/bin/env ruby
require 'simplecov'
SimpleCov.configure do
  command_name 'Docspec'
end
SimpleCov.start

require 'docspec'
require 'colsole'
include Colsole

document = ARGV[0] || 'README.md'
abort "File not found #{document}" unless File.exist? document
document = Docspec::Document.from_file document
document.test

say ''

if document.success?
  say "!txtgrn!#{document.examples.count} tests, #{document.failed_examples.count} failed\n"
  exit 0
else
  say "!txtred!#{document.examples.count} tests, #{document.failed_examples.count} failed\n"
  exit 1
end


